# 工作紀錄 - Odoo Docker 啟動修復

日期：2025-10-22（本地時間）
目標：修復 Odoo（Community 17.0）Docker 環境無法啟動與無法連線問題。

---

## 環境與路徑
- OS：Windows
- 專案根目錄：`c:\Users\o0930\OneDrive\文件\AiDrive\wuchang_comm_incub\wuchang-ai`
- 模組目錄：`./wuchang_comm_incub`（掛載到容器：`/mnt/extra-addons/wuchang_comm_incub`）

---

## 配置檔案重點

### docker-compose.yml（節錄）
- `web` 服務：
  - `image: odoo:17.0`
  - `ports: "8069:8069"`
  - `volumes:`
    - `./wuchang_comm_incub:/mnt/extra-addons/wuchang_comm_incub`
    - `./odoo.conf:/etc/odoo/odoo.conf`
  - `command: --log-level=debug`
- `db` 服務：
  - `image: postgres:15`
  - `volumes: wuchang-db-data:/var/lib/postgresql/data`

### odoo.conf（修正後）
```
[options]
addons_path = /mnt/extra-addons
admin_passwd = <已設定>
```
說明：原先缺少 `[options]`，導致 Odoo 啟動時 `MissingSectionHeaderError`。已修正。

---

## 已執行的操作
1. 清理舊環境：`docker compose down -v`
2. 背景啟動：`docker compose up -d`
3. 檢查容器：`docker compose ps`
   - `wuchang-ai-db-1` Up，`5432/tcp`
   - `wuchang-ai-web-1` Up，`0.0.0.0:8069->8069/tcp`
4. 查看 Web 日誌：`docker compose logs web --tail=200`
   - 出現 `HTTP service (werkzeug) running on ...:8069`（服務已啟動）
   - `HTTP sessions stored in: /root/.local/share/Odoo/sessions`（非致命資訊）
   - `GET /websocket ... 404`（可忽略）

---

## 目前狀態
- 容器與服務：均顯示 Up，web 映射 8069 端口已開。
- 現象：瀏覽器連線仍不穩定／顯示錯誤（用戶端回報）。

---

## 下一步排查與操作
- 本機端測試 HTTP：
  - PowerShell 執行：`Invoke-WebRequest http://localhost:8069/ -UseBasicParsing`
  - 若收到 HTML，表示服務正常，請改用無痕視窗或清除快取再開 `http://localhost:8069/`。
- 若請求失敗，請提供：
  - `docker compose logs web --tail=200`
  - `docker compose logs db --tail=200`

---

## 啟動成功後操作指南
- 進入 `http://localhost:8069/`，資料庫管理密碼：`admin`（compose 環境變數）
- 建立新資料庫（不勾選 Demo data），例如：`wuchang`
- 進入系統後：
  - 開啟開發者模式（`Settings` → `Developer Mode`）
  - 到 `Apps` 更新應用列表（更新索引）
  - 搜尋並安裝模組：`wuchang_comm_incub`

---

## 已解決的根因
- `odoo.conf` 格式錯誤（缺少 `[options]`）導致 Odoo 在載入設定時直接拋 `MissingSectionHeaderError` 而崩潰。現已修正並可正常啟動。

## 尚需確認
- 用戶端瀏覽器的連線問題是否為快取／擴充套件／代理造成。
- 以 PowerShell 本機測試 `localhost:8069` 的結果，決定是否進一步調整網路或防火牆配置。

---

此紀錄檔用於持續追蹤 Odoo Docker 啟動與模組安裝流程，後續變更請持續追加。